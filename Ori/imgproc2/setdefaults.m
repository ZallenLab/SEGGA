% blurradius, blurstrength - Controls the Gaussian blur operation
% that is used to reduce noise in the image. Specifically,
% blurradius controls the size of convolution map that represents
% the blur, and blurstrength controls the standard deviation of
% the Gaussian encoded in the mask. Larger values of blurstrength
% will remove more noise. The bigger the blurradius, the more
% accurate the blur will be, but the longer it will take to
% perform the blur. The goal is to eliminate noise in the
% interior of the cells (by increasing the blur strength/radius),
% while keeping the boundary regions narrow and well defined (by
% decreasing the blur strength/radius).
%
% normradius - The distinction between interior and boundary
% regions is made by comparing pixel intensities with the average
% pixel intensity in the image. If 'Inf' is used here, then the
% average over the entire image is used. If another value is
% entered here, then each pixel is compared to the average
% intensity of pixels within normradius of that pixel. This can
% be used to correct for variations in intensity over the entire
% image. Small values of this parameter will tend to amplify
% noise in the image. The smallest value recommended here is
% about twice the width of the cell boundary regions. A value of
% 'Inf' will perform the fastest. Otherwise, the larger the value
% of this parameter, the longer will be the image
% preprocessing. Set this value to something other than 'Inf' if
% there are intensity variations in the image that lead to large
% black or white regions in the preprocessed interior/boundary
% map image.
%
% Default values for these parameters are set by changing
% the setdefaults.m file
%
% The values in this file are automatically applied to all new
% case images. Changing these values will change the default
% values, while values from saved cases will not be affected.


% declareglobs

%if limit_within is true, then when limiting the working area, its boundary
%will be considered as part of the cells boundaries.
procparams.limit_within = false;

%if auto_limit is true, the program will try and find the boundries of the
%embryo and limit the working area to these boundaries. If the user already
%selected a limited working area, the program will try to find the
%embryo's boundaries within the selected working area.
procparams.auto_limit = false;

%Linear physical resolution. sizefactor = n means the side length of each pixel is
%equal to n * ??? um in real life. The paramaters of the image segmentation
%were optimized for images of a certain magnification (corresponding to a
%pixel size of ??? x ??? um^2 and a size factor of 1). Thus, to correctly
%segment a higher magnification image, the sizefactor should be changed accordingly. 
procparams.sizefactor = 1;


% DLF EDIT 2014 October 24
% procparams.sizefactor = 100/40;


% DLF EDIT 2015 Feb 2
% procparams.sizefactor = 2;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%All of the parameters below should be set for an image with a pixel size
%of ??? x ??? um^2. The program will change them as needed according to the
%sizefactor parameter.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Image normalization radius. Use Inf for no normalization 
procparams.normradius = 15;
procparams.normradius2 = 10;

% Gaussian blur mask size
procparams.blurradius = 2;
procparams.blurradius2 = 3;

% Gaussian blur sigma
procparams.blurstrength = 9;
procparams.blurstrength2 = 7;


% Minimal radius to start from when trying to insert circles.
procparams.minradius = 3;
% maximal radius when trying to insert cells
procparams.maxradius = 25;

%The spacing of the grid on which circles not intersecting white 
%pixels in the mask image are inserted
procparams.grid_spacing = 1;

% The boundary thickness for the remove dupes part. This can be changed 
% from zero if it looks like cells should be allowed to intersect a little
% bit.
procparams.boundary_thickness = 0;

% Cells with area smallel than min_area will be considered spurious and the
% algorithm will try to correct that by removing them. How they are removed
% depends on how many nodes they have. This is done in create_edges.
procparams.min_area = 60;

procparams.short_edge = 0.4; %this parameter determines if an edge is 
% short or not in the correlation calculation. Edges whose lengths are less
% than the median times procparams.short_edge are considered short.


%%%% default cut off values for the highlighting window %%%%%%
%values are in quantiles

% cells number of sides
procparams.highlighting.num_edges_min = 0;
procparams.highlighting.num_edges_max = 1;

% cells area
procparams.highlighting.cell_area_min = 0;
procparams.highlighting.cell_area_max = 1;

% edges length
procparams.highlighting.edges_length_min = 0;
procparams.highlighting.edges_length_max = 0.4; 

% nodes multiplicity
procparams.highlighting.nodes_multi_min = 0;
procparams.highlighting.nodes_multi_max = 1;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Only change this if a specific channel will always be used in
% multi-channel images, and you do not wish to select it for every image. 
procparams.channel = [];
palettes.clusters_colormap = flipud(colormap('jet'));
palettes.clusters_colormap = palettes.clusters_colormap(12:end-5, :);
palettes.clusters_colormap = [ colormap('cool'); colormap('spring');...
    flipud(colormap('autumn')); colormap('hsv'); palettes.clusters_colormap;...
    colormap('winter')];

palettes.numsides_colormap = [...
    0 , 0 , 0;...
    0 , 0 , 0;...
    1 , 1 , 0;...
    1 , 0 , 1;...
    0 , 0 , 1;...
    0.5 , 0.5 , 1;...
    0.5 , 0 , 0.5;...
    0 , 1 , 1;
    0.4 , 0.3 , 0.2;...
    1 , 0.5 , 0;...
    1 , 0 , 0;...
    0.25 , 0.75 , 0.5;...
    0.5 , 0.5 , 0.5;...
    ];

palettes.hsv_colormap = [...
    1 , 0 , 0; ...
    1 , 0.09375 , 0;...
    1 , 0.1875 , 0;...
    1 , 0.28125 , 0;...
    1 , 0.375 , 0;...
    1 , 0.46875 , 0;...
    1 , 0.5625 , 0;...
    1 , 0.65625 , 0;...
    1 , 0.75 , 0;...
    1 , 0.84375 , 0;...
    1 , 0.9375 , 0;...
    0.96875 , 1 , 0;...
    0.875 , 1 , 0;...
    0.78125 , 1 , 0;...
    0.6875 , 1 , 0;...
    0.59375 , 1 , 0;...
    0.5 , 1 , 0;...
    0.40625 , 1 , 0;...
    0.3125 , 1 , 0;...
    0.21875 , 1 , 0;...
    0.125 , 1 , 0;...
    0.03125 , 1 , 0;...
    0 , 1 , 0.0625;...
    0 , 1 , 0.15625;...
    0 , 1 , 0.25;...
    0 , 1 , 0.34375;...
    0 , 1 , 0.4375;...
    0 , 1 , 0.53125;...
    0 , 1 , 0.625;...
    0 , 1 , 0.71875;...
    0 , 1 , 0.8125;...
    0 , 1 , 0.90625;...
    0 , 1 , 1;...
    0 , 0.90625 , 1;...
    0 , 0.8125 , 1;...
    0 , 0.71875 , 1;...
    0 , 0.625 , 1;...
    0 , 0.53125 , 1;...
    0 , 0.4375 , 1;...
    0 , 0.34375 , 1;...
    0 , 0.25 , 1;...
    0 , 0.15625 , 1;...
    0 , 0.0625 , 1;...
    0.03125 , 0 , 1;...
    0.125 , 0 , 1;...
    0.21875 , 0 , 1;...
    0.3125 , 0 , 1;...
    0.40625 , 0 , 1;...
    0.5 , 0 , 1;...
    0.59375 , 0 , 1;...
    0.6875 , 0 , 1;...
    0.78125 , 0 , 1;...
    0.875 , 0 , 1;...
    0.96875 , 0 , 1;...
    1 , 0 , 0.9375;...
    1 , 0 , 0.84375;...
    1 , 0 , 0.75;...
    1 , 0 , 0.65625;...
    1 , 0 , 0.5625;...
    1 , 0 , 0.46875;...
    1 , 0 , 0.375;...
    1 , 0 , 0.28125;...
    1 , 0 , 0.1875;...
    1 , 0 , 0.09375;...
    ];

palettes.jet_colormap = [...
    0 , 0 , 0.5625;...
    0 , 0 , 0.625;...
    0 , 0 , 0.6875;...
    0 , 0 , 0.75;...
    0 , 0 , 0.8125;...
    0 , 0 , 0.875;...
    0 , 0 , 0.9375;...
    0 , 0 , 1;...
    0 , 0.0625 , 1;...
    0 , 0.125 , 1;...
    0 , 0.1875 , 1;...
    0 , 0.25 , 1;...
    0 , 0.3125 , 1;...
    0 , 0.375 , 1;...
    0 , 0.4375 , 1;...
    0 , 0.5 , 1;...
    0 , 0.5625 , 1;...
    0 , 0.625 , 1;...
    0 , 0.6875 , 1;...
    0 , 0.75 , 1;...
    0 , 0.8125 , 1;...
    0 , 0.875 , 1;...
    0 , 0.9375 , 1;...
    0 , 1 , 1;...
    0.0625 , 1 , 0.9375;...
    0.125 , 1 , 0.875;...
    0.1875 , 1 , 0.8125;...
    0.25 , 1 , 0.75;...
    0.3125 , 1 , 0.6875;...
    0.375 , 1 , 0.625;...
    0.4375 , 1 , 0.5625;...
    0.5 , 1 , 0.5;...
    0.5625 , 1 , 0.4375;...
    0.625 , 1 , 0.375;...
    0.6875 , 1 , 0.3125;...
    0.75 , 1 , 0.25;...
    0.8125 , 1 , 0.1875;...
    0.875 , 1 , 0.125;...
    0.9375 , 1 , 0.0625;...
    1 , 1 , 0;...
    1 , 0.9375 , 0;...
    1 , 0.875 , 0;...
    1 , 0.8125 , 0;...
    1 , 0.75 , 0;...
    1 , 0.6875 , 0;...
    1 , 0.625 , 0;...
    1 , 0.5625 , 0;...
    1 , 0.5 , 0;...
    1 , 0.4375 , 0;...
    1 , 0.375 , 0;...
    1 , 0.3125 , 0;...
    1 , 0.25 , 0;...
    1 , 0.1875 , 0;...
    1 , 0.125 , 0;...
    1 , 0.0625 , 0;...
    1 , 0 , 0;...
    0.9375 , 0 , 0;...
    0.875 , 0 , 0;...
    0.8125 , 0 , 0;...
    0.75 , 0 , 0;...
    0.6875 , 0 , 0;
    0.625 , 0 , 0;...
    0.5625 , 0 , 0;...
    0.5 , 0 , 0;...
    ];